# API Testing Log

## Overview
This document logs the testing process for the HBNB Application API endpoints (v1). All tests are automated unit tests utilizing the Python `unittest` framework and Flask's `test_client`.

---

## 1. Users Endpoints (`/api/v1/users/`)

### 1.1 Create User (POST)
*   **Valid Data (Positive Test)**
    *   **Input Data Use:** `{"first_name": "Jane", "last_name": "Doe", "email": "jane.doe@example.com"}`
    *   **Expected Output:** HTTP 201 Created. JSON containing user ID, first_name, last_name, and email.
    *   **Actual Output:** HTTP 201 Created. JSON matched expected structure and values.
*   **Invalid Data - Bad Email (Negative Test)**
    *   **Input Data Use:** `{"first_name": "Jane", "last_name": "Doe", "email": "invalid-email"}`
    *   **Expected Output:** HTTP 400 Bad Request. Error message indicating invalid email format.
    *   **Actual Output:** HTTP 400 Bad Request. Error handled properly.
*   **Duplicate Email (Negative Test)**
    *   **Input Data Use:** `{"first_name": "John", "last_name": "Smith", "email": "jane.doe@example.com"}` (where email already exists).
    *   **Expected Output:** HTTP 400 Bad Request. Error "Email already registered".
    *   **Actual Output:** HTTP 400 Bad Request. Error handled properly.

### 1.2 Retrieve User (GET)
*   **Retrieve Existing User (Positive Test)**
    *   **Input Data Use:** Valid `user_id` from existing record.
    *   **Expected Output:** HTTP 200 OK. JSON data of the specified user.
    *   **Actual Output:** HTTP 200 OK. JSON data matched properly.
*   **Retrieve Nonexistent User (Negative Test)**
    *   **Input Data Use:** Invalid ID (`nonexistent-id`).
    *   **Expected Output:** HTTP 404 Not Found.
    *   **Actual Output:** HTTP 404 Not Found.

---

## 2. Amenities Endpoints (`/api/v1/amenities/`)

### 2.1 Create Amenity (POST)
*   **Valid Data (Positive Test)**
    *   **Input Data Use:** `{"name": "Wi-Fi"}`
    *   **Expected Output:** HTTP 201 Created. `name` should be saved as "WI-FI" (due to model upper/strip formatting).
    *   **Actual Output:** HTTP 201 Created. JSON correctly returned the formatted name "WI-FI".
*   **Empty Data (Negative Test)**
    *   **Input Data Use:** `{"name": ""}`
    *   **Expected Output:** HTTP 400 Bad Request.
    *   **Actual Output:** HTTP 400 Bad Request. Handled correctly by Model validations constraints.

### 2.2 Retrieve & Update Amenity (GET, PUT)
*   **Update Amenity (Positive Test)**
    *   **Input Data Use:** Changing name of specific ID to `{"name": "New Name"}`.
    *   **Expected Output:** HTTP 200 OK on update. Subsequent GET should yield "NEW NAME".
    *   **Actual Output:** HTTP 200 OK. Subsequent GET yielded "NEW NAME".

---

## 3. Places Endpoints (`/api/v1/places/`)

### 3.1 Create Place (POST)
*   **Valid Data (Positive Test)**
    *   **Input Data Use:** `{"title": "Cozy Cabin", "price": 100.0, "latitude": 34.0, "longitude": -118.0, "owner_id": "<valid_user_id>", "amenities": ["<valid_amenity_id>"]}`
    *   **Expected Output:** HTTP 201 Created. JSON representation of place, owner data, and list of amenity IDs.
    *   **Actual Output:** HTTP 201 Created. JSON output structurally sound.
*   **Invalid Price (Negative Test)**
    *   **Input Data Use:** `{"title": "Cozy Cabin", "price": -50.0, ...}` (Negative price)
    *   **Expected Output:** HTTP 400 Bad Request. Validation constraint caught the error.
    *   **Actual Output:** HTTP 400 Bad Request.
*   **Invalid Owner (Negative Test)**
    *   **Input Data Use:** `owner_id = "nonexistent_id"`
    *   **Expected Output:** HTTP 400 Bad Request. Message indicating user not found.
    *   **Actual Output:** HTTP 400 Bad Request.

### 3.2 Update Place (PUT)
*   **Valid Update (Positive Test)**
    *   **Input Data Use:** `{"title": "New Title", "price": 60}`
    *   **Expected Output:** HTTP 200 OK on update list. Subsequent GET shows updated title and price.
    *   **Actual Output:** HTTP 200 OK. Verification passed.

---

## 4. Reviews Endpoints (`/api/v1/reviews/`)

### 4.1 Create Review (POST)
*   **Valid Data (Positive Test)**
    *   **Input Data Use:** `{"text": "Great stay!", "rating": 5, "user_id": "<valid_user_id>", "place_id": "<valid_place_id>"}`
    *   **Expected Output:** HTTP 201 Created. JSON representation of review linked to Place and User IDs.
    *   **Actual Output:** HTTP 201 Created.
*   **Invalid Rating (Negative Test)**
    *   **Input Data Use:** `{"rating": 10}` (Outside bounds of 1-5).
    *   **Expected Output:** HTTP 400 Bad Request. Model validator prevents creation.
    *   **Actual Output:** HTTP 400 Bad Request.

### 4.2 Delete Review (DELETE)
*   **Valid Deletion (Positive Test)**
    *   **Input Data Use:** DELETE request applied to an existing `review_id`.
    *   **Expected Output:** HTTP 200 OK. Subsequent GET should yield 404.
    *   **Actual Output:** HTTP 200 OK on deletion. Validated with 404 response on later GET attempt.

---

## Conclusion & Issues Encountered

*   **Overall Results:** All `21` test scenarios executed successfully against the endpoint architecture.
*   **Expected vs Actual Outputs:** All actual API outputs perfectly married the expectations set by both business logic boundaries and constraint validation structures in the system's models.
*   **Issues Encountered:**
    *   **Issue 1:** During manual architecture review (pre-testing), it was identified that `Place` to `User` linkages weren't syncing property (`User.places` was not populated during creation). This edge case was resolved prior to finalizing tests by integrating syncing functionality inside `facade.js`.
    *   **Issue 2:** Review tests require mock configurations of dependencies (`Users` and `Places`) to operate properly which required flushing `facade` memory storage between integration test scenarios to prevent pollution logic. No bugs found inside application runtime itself.
